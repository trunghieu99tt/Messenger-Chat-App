(this["webpackJsonpmessenger-app"]=this["webpackJsonpmessenger-app"]||[]).push([[0],{100:function(e,a,t){e.exports=t.p+"static/media/register.98d17d5f.jpg"},119:function(e,a,t){e.exports=t(208)},162:function(e,a,t){},206:function(e,a,t){},207:function(e,a,t){},208:function(e,a,t){"use strict";t.r(a);var n=t(4),r=t(5),s=t(7),l=t(6),c=(t(120),t(121),t(0)),i=t.n(c),o=t(10),u=t.n(o),d=t(9),m=t(24),h=t(28),p=t(27),g=t(103),f=t(12),v=t(78),b=t.n(v);t(130),t(132),t(209);b.a.initializeApp({apiKey:"AIzaSyAjaWoFEJ49khltVojcuEjgTSHXrMODptI",authDomain:"messenger-app-9e350.firebaseapp.com",databaseURL:"https://messenger-app-9e350.firebaseio.com",projectId:"messenger-app-9e350",storageBucket:"messenger-app-9e350.appspot.com",messagingSenderId:"820968672244",appId:"1:820968672244:web:3646985195957ad99e07a1",measurementId:"G-XHFW33K765"});var E=b.a,C=function(e){return{type:"SET_CURRENT_CHANNEL",payload:{currentChannel:e}}},y=t(212),_=function(e){var a=e.handleSearchChange;return i.a.createElement("form",{className:"search-bar",onSubmit:a},i.a.createElement("input",{type:"text",placeholder:"Search",className:"search-bar__input",onChange:a}),i.a.createElement(y.a,{className:"search-bar__icon"}))},S=Object(d.b)(null,{setCurrentChannel:C})((function(e){var a,n=e.image,r=e.name,s=e.lastMessage,l=e.currentChatting,c=e.handleClick;return i.a.createElement("div",{className:"messages-list-card",onClick:c},i.a.createElement("figure",{className:"messages-list-card__image-container"},i.a.createElement("img",{className:"".concat(l?"image-outlined":""," rounded messages-list-card__image"),src:n||t(86),alt:"".concat(r," avatar")})),i.a.createElement("div",{className:"messages-list-card__infor"},i.a.createElement("p",{className:"messages-list-card__username"},r),i.a.createElement("p",{className:"messages-list-card__lastMessage"},(null===(a=s)||void 0===a?void 0:a.hasOwnProperty("image"))?"".concat(r," \u0111\xe3 g\u1eedi 1 \u1ea3nh"):"".concat((null===s||void 0===s?void 0:s.content)||""))))})),N=function(e){Object(s.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=a.call.apply(a,[this].concat(s))).state={messagesRef:E.database().ref("messages"),usersRef:E.database().ref("users"),users:[],messages:[]},e.addListeners=function(a){e.addMessageListener(a)},e.addMessageListener=function(a){var t=e.state.messagesRef,n=[],r=[];t.child(a).on("child_added",(function(a){var t=a.key,s=Object.values(a.val());r.includes(t)||(n.push({messages:null===s||void 0===s?void 0:s[s.length-1],userId:t}),r.push(t),e.setState({messages:n,users:r,messagesLoading:!1}))}))},e.handleClick=function(a){(0,e.props.setCurrentChannel)(a)},e}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.currentUser;e&&this.addListeners(e.uid)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var a=e.currentUser;a&&this.addListeners(a.uid)}},{key:"render",value:function(){var e=this,a=this.props.otherUsers,t=this.state,n=t.messages,r=t.users;return i.a.createElement("section",{className:"messages-list-panel"},i.a.createElement(_,null),i.a.createElement("div",{className:"messages-list-panel__main"},null===a||void 0===a?void 0:a.filter((function(e){return r.includes(e.uid)})).map((function(a,t){var r=a.avatar,s=a.name,l=a.uid,c=n.find((function(e){return e.userId===l}));return i.a.createElement(S,{name:s||"",image:r||"",currentChatting:0===t,lastMessage:(null===c||void 0===c?void 0:c.messages)||"",handleClick:function(){return e.handleClick(a)}})}))))}}]),t}(c.Component),O=Object(d.b)((function(e){return{currentUser:e.user.currentUser}}),{setCurrentChannel:C})(N),j=t(18),U=t.n(j),k=t(37),w=t(22),R=t(213),L=t(79),A=t.n(L),T=t(105),M=t.n(T),x=function(e){Object(s.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=a.call.apply(a,[this].concat(s))).state={message:"",loading:!1,errors:[],uploadState:"",uploadTask:null,storageRef:E.storage().ref(),percentUploaded:0,file:null,authorized:["image/jpeg","image/png"]},e.handleChange=function(a){return e.setState(Object(w.a)({},a.target.name,a.target.value))},e.createMessage=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e.state.message,n=e.props.user,r={timestamp:E.database.ServerValue.TIMESTAMP,time:new Date,content:t,sentBy:{id:(null===n||void 0===n?void 0:n.uid)||Math.random(),name:(null===n||void 0===n?void 0:n.displayName)||"Unknown",avatar:(null===n||void 0===n?void 0:n.photoUrl)||"Unknown"}};return a&&(r.image=a),r},e.sendMessage=function(){var a=Object(k.a)(U.a.mark((function a(t){var n,r,s,l;return U.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.preventDefault(),n=e.props,r=n.messagesRef,s=n.currentChannel,l=n.user,!e.state.message){a.next=19;break}return e.setState({loading:!0}),a.prev=5,a.next=8,r.child(s.uid).child(l.uid).push().set(e.createMessage());case 8:return a.next=10,r.child(l.uid).child(s.uid).push().set(e.createMessage());case 10:e.setState({loading:!1,message:"",errors:[]}),a.next=17;break;case 13:a.prev=13,a.t0=a.catch(5),console.log("err",a.t0),e.setState({loading:!1,message:"",errors:[].concat(Object(f.a)(e.state.errors),[a.t0])});case 17:a.next=20;break;case 19:e.setState({errors:[].concat(Object(f.a)(e.state.errors),[{message:"Add a message"}])});case 20:case"end":return a.stop()}}),a,null,[[5,13]])})));return function(e){return a.apply(this,arguments)}}(),e.getPath=function(){return"messages/users"},e.uploadFile=function(a,t){var n=e.props,r=n.currentChannel,s=n.messagesRef,l=n.user,c=r.uid,i=l.uid,o="".concat(e.getPath(),"/").concat(M()(),".jpg");e.setState({uploadState:"uploading",uploadTask:e.state.storageRef.child(o).put(a,t)},(function(){e.state.uploadTask.on("state_changed",(function(a){var t=100*Math.round(a.bytesTransferred/a.totalBytes);e.setState({percentUploaded:t})}),(function(a){console.log("err",a),e.setState({errors:[].concat(Object(f.a)(e.state.errors),[a]),uploadState:"error",uploadTask:null})}),(function(){console.log("this.state.uploadTask.snapshot",e.state.uploadTask.snapshot),e.state.uploadTask.snapshot.ref.getDownloadURL().then((function(a){e.sendFileMessage(a,s,c,i)})).catch((function(a){console.log("err",a),e.setState({errors:[].concat(Object(f.a)(e.state.errors),[a]),uploadState:"error",uploadTask:null})}))}))}))},e.sendFileMessage=function(a,t,n,r){t.child(n).child(r).push().set(e.createMessage(a)).then((function(){return e.setState({uploadState:"done"})})).catch((function(a){console.log("err: ",a),e.setState({errors:[].concat(Object(f.a)(e.state.errors),[a])})})),t.child(r).child(n).push().set(e.createMessage(a)).then((function(){return e.setState({uploadState:"done"})})).catch((function(a){console.log("err: ",a),e.setState({errors:[].concat(Object(f.a)(e.state.errors),[a])})}))},e.addFile=function(a){var t=a.target.files[0];console.log("file",t),t&&e.setState({file:t},(function(){return e.sendFile()}))},e.sendFile=function(){var a=e.state.file;if(null!==a&&e.isAuthorized(a.name)){var t={contentType:A.a.lookup(a.name)};e.uploadFile(a,t),e.clearFile()}},e.isAuthorized=function(a){return e.state.authorized.includes(A.a.lookup(a))},e.clearFile=function(){return e.setState({file:null})},e}return Object(r.a)(t,[{key:"render",value:function(){var e=this.state.message;this.props.currentChannel;return i.a.createElement("form",{className:"message-form",onSubmit:this.sendMessage},i.a.createElement("input",{type:"text",name:"message",placeholder:"Type your message here...",className:"message-form__input",onChange:this.handleChange,value:e}),i.a.createElement("span",null,i.a.createElement("label",{htmlFor:"upload-photo",className:"message-form__file-label"},i.a.createElement(R.a,null)),i.a.createElement("input",{type:"file",name:"file",id:"upload-photo",className:"message-form__file",onChange:this.addFile})))}}]),t}(c.Component),P=t(210),I=function(e){Object(s.a)(t,e);var a=Object(l.a)(t);function t(){return Object(n.a)(this,t),a.apply(this,arguments)}return Object(r.a)(t,[{key:"render",value:function(){var e,a,t,n=this.props,r=n.channel,s=n.handleSearchChange;n.searchLoading;return i.a.createElement("section",{className:"messages-panel-header"},i.a.createElement("div",{className:"row align-items-center"},i.a.createElement("div",{className:"col-lg-5"},r&&i.a.createElement("figure",{className:"messages-panel-header__image-container"},i.a.createElement("img",{src:null!==(e=null===r||void 0===r?void 0:r.avatar)&&void 0!==e?e:"",alt:null!==(a=null===r||void 0===r?void 0:r.name)&&void 0!==a?a:"user avatar",className:"rounded messages-panel-header__image"}),i.a.createElement("figcaption",{className:"messages-panel-header__infor"},i.a.createElement("p",{className:"messages-panel-header__name"},(null===r||void 0===r?void 0:r.name)||"Unknown"),i.a.createElement(P.a,{color:"online"===(null===r||void 0===r?void 0:r.status)?"green":"red",className:"messages-panel-header__status"},null!==(t=null===r||void 0===r?void 0:r.status)&&void 0!==t?t:"offline")))),i.a.createElement("div",{className:"col-lg-7"},i.a.createElement(_,{handleSearchChange:s}))))}}]),t}(c.Component),F=t(107),D=t.n(F),B=function(e,a){var t;return(null===e||void 0===e||null===(t=e.sentBy)||void 0===t?void 0:t.id)===(null===a||void 0===a?void 0:a.uid)?"message__self":""},W=function(e,a){var t;return(null===e||void 0===e||null===(t=e.sentBy)||void 0===t?void 0:t.id)===(null===a||void 0===a?void 0:a.uid)?"self":"not-self"},q=function(e){return D()(e).fromNow()},V=function(e){var a,t=e.message,n=e.user;return i.a.createElement(i.a.Fragment,null,function(e){return e.hasOwnProperty("image")}(t)?i.a.createElement("div",{className:"message ".concat(B(t,n))},i.a.createElement("img",{src:null===t||void 0===t?void 0:t.image,className:"message__image ".concat(W(t,n)),alt:"".concat(null===t||void 0===t?void 0:t.image)}),i.a.createElement("p",{className:"message__time"},q(t.timestamp))):i.a.createElement("div",{className:"message ".concat(B(t,n))},i.a.createElement("figure",{className:"message__user-avatar-container"},i.a.createElement("img",{className:"rounded message__user-avatar",src:null===t||void 0===t||null===(a=t.sentBy)||void 0===a?void 0:a.avatar,alt:""})),i.a.createElement("div",null,i.a.createElement("p",null,null===t||void 0===t?void 0:t.content)),i.a.createElement("p",{className:"message__time"},q(t.timestamp))))},H=function(e){Object(s.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=a.call.apply(a,[this].concat(s))).state={showMessages:[]},e.updateScroll=function(){var e=document.querySelector(".messages-panel-main");e&&e.scrollTop&&e.scrollHeight&&(e.scrollTop=e.scrollHeight)},e}return Object(r.a)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var a=e.messages;this.setState({showMessages:a}),this.updateScroll()}},{key:"componentDidMount",value:function(){this.updateScroll()}},{key:"render",value:function(){var e=this.props,a=e.currentUser,t=e.currentChannel,n=e.searchResults,r=this.state.showMessages,s=(null===n||void 0===n?void 0:n.length)&&n||r;return i.a.createElement("section",{className:"messages-panel-main",key:Math.random()},(null===s||void 0===s?void 0:s.length)>0&&s.map((function(e){return i.a.createElement(V,{key:e.timestamp,message:e,user:a,channel:t})})))}}]),t}(c.Component),z=function(e){Object(s.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=a.call.apply(a,[this].concat(s))).state={messagesRef:E.database().ref("messages"),user:e.props.currentUser,messages:[],progressBar:!1,messagesLoading:!0,numUniqueUsers:"",searchTerm:"",searchLoading:!1,searchResults:[]},e.addListeners=function(a){e.addMessageListener(a)},e.addMessageListener=function(a){var t=e.props.currentUser,n=e.state.messagesRef,r=[];n.child(a).child(t.uid).on("child_added",(function(a){r.push(a.val()),e.setState({messages:r,messagesLoading:!1})}))},e.handleSearchChange=function(a){a.preventDefault(),e.setState({searchTerm:a.target.value,searchLoading:!0},(function(){return e.handleSearchMessages()}))},e.handleSearchMessages=function(){var a=Object(f.a)(e.state.messages),t=new RegExp(e.state.searchTerm,"gi"),n=a.reduce((function(e,a){var n;return(a&&a.content&&a.content.match(t)||(null===a||void 0===a||null===(n=a.sentBy)||void 0===n?void 0:n.name.match(t)))&&e.push(a),e}),[]);e.setState({searchResults:n}),setTimeout((function(){e.setState({searchLoading:!1})}),1e3)},e}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,a=e.currentUser,t=e.currentChannel;t&&a&&this.addListeners(t.uid)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var a=e.currentUser,t=e.currentChannel;t&&a&&this.addListeners(t.uid)}},{key:"render",value:function(){var e=this.state,a=e.messagesRef,t=(e.user,e.messages),n=e.searchResults,r=(e.searchTerm,e.searchLoading),s=this.props,l=s.currentChannel,c=s.currentUser;return i.a.createElement("section",{className:"messages-panel"},i.a.createElement(I,{channel:null!==l&&void 0!==l?l:null,handleSearchChange:this.handleSearchChange,searchLoading:r}),i.a.createElement(H,{messages:t,searchResults:n,currentUser:c,currentChannel:l}),i.a.createElement(x,{messagesRef:a,currentChannel:l,user:c,isProgressBarVisible:this.isProgressBarVisible}))}}]),t}(c.Component),J=Object(d.b)((function(e){return{currentChannel:e.channel.currentChannel}}))(z),K=function(e){var a=e.image,t=e.name,n=e.isOnline,r=e.userId,s=e.handleClick;return i.a.createElement("div",{className:"friend-card",key:"friend-card-".concat(r),onClick:s},i.a.createElement("figure",{className:"friend-card__image-container"},i.a.createElement("img",{className:"friend-card__image w-100 rounded ".concat(n?"image-outlined":""),src:a,alt:"".concat(t," avatar")})),i.a.createElement("p",{className:"friend-card__name"},t),i.a.createElement(P.a,{color:n?"green":"red",className:"ml-auto"},n?"Online":"Offline"))},X=function(e){Object(s.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=a.call.apply(a,[this].concat(s))).state={usersList:[]},e.handleClick=function(a){(0,e.props.setCurrentChannel)(a)},e}return Object(r.a)(t,[{key:"render",value:function(){var e,a=this,t=this.props,n=t.userList;t.setCurrentChannel,t.users;return i.a.createElement("section",{className:"friends-list"},i.a.createElement("header",{className:"friends-list__header"},i.a.createElement("h3",null,"Friends(",null!==(e=null===n||void 0===n?void 0:n.length)&&void 0!==e?e:0,") ")),i.a.createElement("div",{className:"friends-list__main-list"},(null===n||void 0===n?void 0:n.length)&&n.map((function(e){var t=e.avatar,n=e.name,r=e.status,s=e.uid;return i.a.createElement(K,{image:t,name:n,isOnline:"online"===r,userId:s,handleClick:function(){return a.handleClick(e)}})}))))}}]),t}(c.Component),G=Object(d.b)((function(e){return{users:e.user.users}}),{setCurrentChannel:C})(X),$=t(214),Q=t(215),Y=function(e){var a=e.photoURL,n=e.displayName,r=e.activeToolbarItem;return i.a.createElement("section",{className:"user-infor"},i.a.createElement("figure",{className:"user-infor__image-container"},i.a.createElement("img",{className:"user-infor__image rounded image-outlined",src:a||t(86),alt:"".concat(n," avatar")}),i.a.createElement("figcaption",{className:"user-infor__name"},i.a.createElement("p",null,n))),i.a.createElement("div",{className:"toolbar"},i.a.createElement("div",{className:"toolbar-item active",toolbaritemid:1,onClick:function(e){return r(e,!1)}},i.a.createElement($.a,null),i.a.createElement("span",{className:"toolbar-item__text"},"Chat")),i.a.createElement("div",{className:"toolbar-item",toolbaritemid:3,onClick:function(e){return r(e,!0)}},i.a.createElement(Q.a,null),i.a.createElement("span",{className:"toolbar-item__text"},"LogOut"))))},Z=function(e){Object(s.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=a.call.apply(a,[this].concat(s))).state={connectedRef:E.database().ref(".info/connected"),presenceRef:E.database().ref("presence"),users:[],usersRef:E.database().ref("users")},e.addListener=function(a){var t=[],n=e.state,r=n.usersRef,s=n.connectedRef,l=n.presenceRef;e.props.saveUsers;r.on("child_added",(function(n){if(a!==n.key){var r=n.val();r.uid=n.key,r.status="offline",t.push(r),e.setState({users:t})}})),s.on("value",(function(e){if(e.val()){var t=l.child(a);t.set(!0),t.onDisconnect().remove((function(e){null!==e&&console.log("err",e)}))}})),l.on("child_added",(function(t){a!==t.key&&e.addStatusToUser(t.key)})),l.on("child_removed",(function(t){a!==t.key&&e.addStatusToUser(t.key,!1)}))},e.addStatusToUser=function(a){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.state.users,r=e.props.setUsers,s=n.reduce((function(e,n){return n.uid===a&&(n.status="".concat(t?"online":"offline")),[].concat(Object(f.a)(e),[n])}),[]);"function"===typeof r&&r(s)},e.isUserOnline=function(e){return"online"===e.status},e.changeChannel=function(a){var t={id:e.getChannelId(a.uid),name:a.name};e.props.setCurrentChannel(t),e.props.setPrivateChannel(!0),e.setActiveChannel(a.uid)},e.setActiveChannel=function(a){e.setState({activeChannel:a})},e.getChannelId=function(a){var t=e.state.user.uid;return a<t?"".concat(a,"/").concat(t):"".concat(t,"/").concat(a)},e.activeToolbarItem=function(a,t){var n,r,s=null!==(n=null===a||void 0===a||null===(r=a.target)||void 0===r?void 0:r.getAttribute("toolbaritemid"))&&void 0!==n?n:0;document.querySelectorAll(".toolbar-item").forEach((function(e){(null===e||void 0===e?void 0:e.getAttribute("toolbaritemid"))===s?e.classList.add("active"):e.classList.remove("active")})),t&&e.handleSignOut()},e.handleSignOut=function(){return E.auth().signOut().then((function(){return console.log("Signed out!")}))},e}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.currentUser;e||this.props.history.push("/login"),e&&this.addListener(e.uid)}},{key:"render",value:function(){var e=this.props,a=e.currentUser,t=e.history,n=(e.otherUsers,this.state),r=(n.allUsers,n.users);if(a){var s=a.displayName,l=a.photoURL;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Y,{photoURL:l,displayName:s,activeToolbarItem:this.activeToolbarItem}),i.a.createElement(G,{userList:r,key:Math.random()}))}return t.push("/login"),null}}]),t}(c.Component),ee=Object(m.g)(Object(d.b)((function(e){return{currentUser:e.user.currentUser,users:e.user.users}}))(Z)),ae=function(e){Object(s.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=a.call.apply(a,[this].concat(s))).state={usersRef:E.database().ref("users"),connectedRef:E.database().ref(".info/connected"),presenceRef:E.database().ref("presence"),users:[]},e.addListener=function(a){var t=[],n=e.state,r=n.usersRef,s=n.connectedRef,l=n.presenceRef,c=e.props.saveUsers;r.on("child_added",(function(n){if(a!==n.key){var r=n.val();r.uid=n.key,r.status="offline",t.push(r),e.setState({users:t}),c(t)}})),s.on("value",(function(e){if(e.val()){var t=l.child(a);t.set(!0),t.onDisconnect().remove((function(e){null!==e&&console.log("err",e)}))}})),l.on("child_added",(function(t){a!==t.key&&e.addStatusToUser(t.key)})),l.on("child_removed",(function(t){a!==t.key&&e.addStatusToUser(t.key,!1)}))},e.addStatusToUser=function(a){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.state.users,r=e.props.setUsers,s=n.reduce((function(e,n){return n.uid===a&&(n.status="".concat(t?"online":"offline")),[].concat(Object(f.a)(e),[n])}),[]);"function"===typeof r&&r(s)},e.isUserOnline=function(e){return"online"===e.status},e.changeChannel=function(a){var t={id:e.getChannelId(a.uid),name:a.name};e.props.setCurrentChannel(t),e.props.setPrivateChannel(!0),e.setActiveChannel(a.uid)},e.setActiveChannel=function(a){e.setState({activeChannel:a})},e.getChannelId=function(a){var t=e.state.user.uid;return a<t?"".concat(a,"/").concat(t):"".concat(t,"/").concat(a)},e}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.currentUser;e&&this.addListener(e.uid)}},{key:"render",value:function(){var e=this.props,a=e.currentUser,t=e.currentChannel,n=this.state.users;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row app"},i.a.createElement("div",{className:"col-lg-3"},i.a.createElement(ee,{currentUser:a,otherUsers:n})),i.a.createElement("div",{className:"col-lg-3",style:{borderLeft:"1px solid #e6e6e6",borderRight:"1px solid #e6e6e6"}},i.a.createElement(O,{user:a,otherUsers:n})),i.a.createElement("div",{className:"col-lg-6"},i.a.createElement(J,{currentChannel:t,currentUser:a}))))}}]),t}(c.Component),te=Object(d.b)((function(e){return{currentUser:e.user.currentUser,currentChannel:e.channel.currentChannel,isPrivateChannel:e.channel.isPrivateChannel}}),{saveUsers:function(e){return{type:"SAVE_USERS",payload:{users:e}}}})(ae),ne=(t(162),t(211)),re=t(56),se=function(e){var a=e.handleChange,t=e.label,n=Object(re.a)(e,["handleChange","label"]);return i.a.createElement("div",{className:"group"},i.a.createElement("input",Object.assign({className:"form-input",onChange:a},n)),t?i.a.createElement("label",{className:"".concat(n.value.length?"shrink":""," form-input-label")},t):null)},le=function(e){var a=e.children,t=Object(re.a)(e,["children"]);return i.a.createElement("button",Object.assign({className:"button--1"},t),a)},ce=function(){return i.a.createElement("div",{className:"ripple-loader"},i.a.createElement("div",null),i.a.createElement("div",null))},ie=function(){return i.a.createElement("div",{className:"mask"},i.a.createElement(ce,null))},oe=function(e){Object(s.a)(c,e);var a=Object(l.a)(c);function c(){var e;Object(n.a)(this,c);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).state={email:"",password:"",loading:!1,userRef:E.database().ref("users")},e.handleChange=function(a){e.setState(Object(w.a)({},a.target.name,a.target.value))},e.handleSubmit=function(){var a=Object(k.a)(U.a.mark((function a(t){var n,r,s;return U.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.preventDefault(),n=e.state,r=n.email,s=n.password,e.setState({loading:!0}),a.prev=3,a.next=6,E.auth().signInWithEmailAndPassword(r,s);case 6:a.sent,e.setState({loading:!1}),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(3),e.failedAlert(a.t0.message),e.setState({loading:!1});case 14:case"end":return a.stop()}}),a,null,[[3,10]])})));return function(e){return a.apply(this,arguments)}}(),e.successAlert=function(){return ne.a.success("User created successfully")},e.failedAlert=function(e){return ne.a.error(e)},e}return Object(r.a)(c,[{key:"render",value:function(){var e=this.state,a=e.email,n=e.password,r=e.loading;return i.a.createElement(i.a.Fragment,null,i.a.createElement("section",{className:"login"},i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"row form__main"},i.a.createElement("div",{className:"col-lg-6 login__form-container"},i.a.createElement("div",{className:"form__heading"},"Login"),i.a.createElement("form",{onSubmit:this.handleSubmit,className:"login__form"},i.a.createElement(se,{name:"email",type:"email",handleChange:this.handleChange,value:a,label:"Email",required:!0}),i.a.createElement(se,{name:"password",type:"password",handleChange:this.handleChange,value:n,label:"Password",required:!0}),i.a.createElement(le,{type:"submit",onSubmit:this.handleSubmit},"Sign In"),i.a.createElement("span",{className:"form__add-info"},"Don't have an account ?"," ",i.a.createElement(h.b,{to:"/register"},"Register")))),i.a.createElement("div",{className:"col-lg-6 form__image-container"},i.a.createElement("img",{src:t(100),alt:"",className:"w-100 login__image "})))),r?i.a.createElement(ie,null):null))}}]),c}(c.Component),ue=t(117),de=t.n(ue),me=function(e){Object(s.a)(c,e);var a=Object(l.a)(c);function c(){var e;Object(n.a)(this,c);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).state={username:"",email:"",password:"",passwordConfirm:"",loading:!1,userRef:E.database().ref("users")},e.handleChange=function(a){e.setState(Object(w.a)({},a.target.name,a.target.value))},e.isPasswordValid=function(e){return e.password===e.passwordConfirm},e.handleSubmit=function(){var a=Object(k.a)(U.a.mark((function a(t){var n,r,s,l,c;return U.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.preventDefault(),!e.isPasswordValid(e.state)){a.next=21;break}return n=e.state,r=n.email,s=n.password,l=n.username,e.setState({loading:!0}),a.prev=4,a.next=7,E.auth().createUserWithEmailAndPassword(r,s);case 7:return c=a.sent,a.next=10,c.user.updateProfile({displayName:l,photoURL:"https://gravatar.com/avatar/".concat(de()(c.user.email),"?d=identical")});case 10:return a.next=12,e.saveUser(c);case 12:e.successAlert(),e.setState({loading:!1}),a.next=21;break;case 16:a.prev=16,a.t0=a.catch(4),console.log("err",a.t0),e.failedAlert(a.t0.message),e.setState({loading:!1});case 21:case"end":return a.stop()}}),a,null,[[4,16]])})));return function(e){return a.apply(this,arguments)}}(),e.successAlert=function(){return ne.a.success("User created successfully")},e.failedAlert=function(e){return ne.a.error(e)},e.saveUser=function(a){return e.state.userRef.child(a.user.uid).set({name:a.user.displayName,avatar:a.user.photoURL})},e}return Object(r.a)(c,[{key:"render",value:function(){var e=this.state,a=e.username,n=e.email,r=e.password,s=e.passwordConfirm,l=e.loading;return i.a.createElement(i.a.Fragment,null,i.a.createElement("section",{className:"register"},i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"row form__main"},i.a.createElement("div",{className:"col-lg-6 register__form-container"},i.a.createElement("div",{className:"form__heading"},"Register Now!"),i.a.createElement("form",{onSubmit:this.handleSubmit,className:"register__form"},i.a.createElement(se,{name:"username",type:"text",handleChange:this.handleChange,value:a,label:"Username",required:!0}),i.a.createElement(se,{name:"email",type:"email",handleChange:this.handleChange,value:n,label:"Email",required:!0}),i.a.createElement(se,{name:"password",type:"password",handleChange:this.handleChange,value:r,label:"Password",required:!0}),i.a.createElement(se,{name:"passwordConfirm",type:"password",handleChange:this.handleChange,value:s,label:"Confirm Password",required:!0}),i.a.createElement(le,{type:"submit",onSubmit:this.handleSubmit},"Register Now!"),i.a.createElement("span",{className:"form__add-info"},"Do you have an account ?"," ",i.a.createElement(h.b,{to:"/login"},"Login")))),i.a.createElement("div",{className:"col-lg-6 form__image-container"},i.a.createElement("img",{src:t(100),alt:"",className:"w-100 register__image "})))),l?i.a.createElement(ie,null):null))}}]),c}(c.Component),he=(t(206),t(29)),pe={currentChannel:null,isPrivateChannel:!1},ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_CURRENT_CHANNEL":return Object(he.a)({},e,{currentChannel:a.payload.currentChannel});case"SET_PRIVATE_CHANNEL":return Object(he.a)({},e,{isPrivateChannel:a.payload.isPrivateChannel});default:return e}},fe={users:[],currentUser:null,isLoading:!0},ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_USER":return Object(he.a)({},e,{currentUser:a.payload.currentUser,isLoading:!1});case"CLEAR_USER":return Object(he.a)({},e,{currentUser:null,isLoading:!1});case"SAVE_USERS":return Object(he.a)({},e,{users:a.payload.users});default:return e}},be=Object(p.combineReducers)({user:ve,channel:ge});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(207);var Ee=Object(p.createStore)(be,Object(g.composeWithDevTools)()),Ce=function(e){Object(s.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(e=a.call.apply(a,[this].concat(s))).goToLogin=function(){return i.a.createElement(m.a,{to:"/login"})},e}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this,a=this.props,t=a.setUser,n=a.clearUser;E.auth().onAuthStateChanged((function(a){a?(t(a),e.props.history.push("/")):(n(),e.goToLogin(),e.props.history.push("/login"))}))}},{key:"render",value:function(){return this.props.isLoading?i.a.createElement(ie,null):i.a.createElement(m.d,null,i.a.createElement(m.b,Object.assign({exact:!0,path:"/",component:te},this.props)),i.a.createElement(m.b,{exact:!0,path:"/register",component:me}),i.a.createElement(m.b,{exact:!0,path:"/login",component:oe}))}}]),t}(c.Component),ye=Object(m.g)(Object(d.b)((function(e){return{isLoading:e.user.isLoading}}),{setUser:function(e){return{type:"SET_USER",payload:{currentUser:e}}},clearUser:function(){return{type:"CLEAR_USER"}}})(Ce));u.a.render(i.a.createElement(d.a,{store:Ee},i.a.createElement(h.a,null,i.a.createElement(ye,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},86:function(e,a,t){e.exports=t.p+"static/media/default-avatar.5097b024.png"}},[[119,1,2]]]);
//# sourceMappingURL=main.5f6d563a.chunk.js.map